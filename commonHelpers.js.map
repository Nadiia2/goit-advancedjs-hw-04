{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst API_KEY = '43435649-9580751e4a32127232b1b0155';\n\nexport async function fetchImages(query, page, perPage) {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: perPage,\n    page: page,\n  });\n  const response = await axios.get(`${BASE_URL}/?${searchParams}`);\n  return response.data.hits;\n}\n","export function generateImageHTML(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n            width=\"360\"\n          />\n        </a>\n        <div class=\"info\">\n          <div class=\"block\">\n            <h2 class=\"title\">Likes</h2>\n            <p class=\"amount\">${likes}</p>\n          </div>\n          <div class=\"block\">\n            <h2 class=\"title\">Views</h2>\n            <p class=\"amount\">${views}</p>\n          </div>\n          <div class=\"block\">\n            <h2 class=\"title\">Comments</h2>\n            <p class=\"amount\">${comments}</p>\n          </div>\n          <div class=\"block\">\n            <h2 class=\"title\">Downloads</h2>\n            <p class=\"amount\">${downloads}</p>\n          </div>\n        </div>\n      </li>`\n    )\n    .join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api.js';\nimport { generateImageHTML } from './js/render-functions.js';\n\nconst form = document.querySelector('.form');\nconst imageList = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst nextBtn = document.querySelector('#next-btn');\n\nconst gallery = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet currentPage = 1;\nlet searchValue = '';\nlet isLoading = false;\n\nform.addEventListener('submit', handleSearch);\nnextBtn.addEventListener('click', loadMore);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  const searchRequest = form.querySelector('input').value.trim();\n  if (!searchRequest) {\n    showErrorMessage('Please, fill in the search field');\n    return;\n  }\n\n  if (searchValue !== searchRequest) {\n    currentPage = 1;\n    searchValue = searchRequest;\n    imageList.innerHTML = '';\n  }\n\n  try {\n    const images = await fetchImages(searchRequest, currentPage, 15);\n    if (images.length === 0) {\n      showErrorMessage(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    } else {\n      imageList.innerHTML += generateImageHTML(images);\n      gallery.refresh();\n      if (images.length >= 15) {\n        nextBtn.classList.remove('is-hidden');\n      } else {\n        nextBtn.classList.add('is-hidden');\n      }\n      scrollBy();\n      currentPage++;\n    }\n    form.querySelector('input').value = '';\n  } catch (err) {\n    handleError(err);\n  }\n}\n\nasync function loadMore() {\n  if (isLoading) return;\n  isLoading = true;\n  loader.classList.remove('is-hidden');\n  try {\n    const images = await fetchImages(searchValue, currentPage);\n    if (images.length === 0) {\n      nextBtn.classList.add('is-hidden');\n      iziToast.show({\n        theme: 'light',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageSize: '16px',\n        messageColor: '#f80303',\n        backgroundColor: '#ebe268',\n        position: 'topRight',\n        timeout: 5000,\n      });\n    } else {\n      imageList.innerHTML += generateImageHTML(images);\n      gallery.refresh();\n      currentPage++;\n      scrollBy();\n    }\n  } catch (error) {\n    handleError(error);\n  } finally {\n    isLoading = false;\n    loader.classList.add('is-hidden');\n  }\n}\n\nfunction showErrorMessage(message) {\n  iziToast.show({\n    theme: 'light',\n    message: message,\n    messageSize: '16px',\n    messageColor: '#f80303',\n    backgroundColor: '#ebe268',\n    position: 'topRight',\n    timeout: 5000,\n  });\n}\n\nfunction handleError(error) {\n  console.error(error);\n  iziToast.show({\n    theme: 'light',\n    message: 'Sorry, there is a problem with the connection to the server.',\n    messageSize: '16px',\n    messageColor: 'white',\n    backgroundColor: '#EF4040',\n    position: 'center',\n    timeout: 7000,\n  });\n}\n\nfunction scrollBy() {\n  const imageHeight = document\n    .querySelector('.gallery-item')\n    .getBoundingClientRect().height;\n  window.scrollBy({\n    top: imageHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","API_KEY","fetchImages","query","page","perPage","searchParams","axios","generateImageHTML","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","form","imageList","loader","nextBtn","gallery","SimpleLightbox","currentPage","searchValue","isLoading","handleSearch","loadMore","event","searchRequest","showErrorMessage","scrollBy","err","handleError","iziToast","error","message","imageHeight"],"mappings":"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"}